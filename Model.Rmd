---
title: "final_data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
load("mergedData.RData")
```

```{r}
library(geeM)
library(dplyr)
```

```{r}
colnames(data)

data <- data %>% na.omit()
```

```{r}
model <- geem(rider_number ~ avg_duration + avg_dist + TemperatureCat +  HumidityCat+ WindCat + IncomeE + PopE + `Race_White alone` + distToWM + distToGU, id = start_station_id, data = data, corstr = "ar1")
```

```{r}
model_1 <- geem(rider_number ~ avg_duration + avg_dist + TemperatureCat +  HumidityCat+ WindCat + IncomeE + PopE + `Race_White alone` + distToWM + distToGU, id = start_station_id, data = data, corstr = "independence")
```

```{r}
model_2 <- geem(rider_number ~ avg_duration + avg_dist + TemperatureCat +  HumidityCat+ WindCat + IncomeE + PopE + `Race_White alone` + distToWM + distToGU, id = start_station_id, data = data, corstr = "exchangeable")
```

```{r}
summary(model)
summary(model_1)
summary(model_2)
```
```{r}
resid = model$y - predict(model)
plot(predict(model), resid)
```

```{r}
resid = model_1$y - predict(model_1)
plot(predict(model_1), resid)
```


```{r}
resid = model_2$y - predict(model_2)
plot(predict(model_2), resid)
```


